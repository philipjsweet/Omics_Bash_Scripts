## Goal: Find regions of homology in the ScY55 and ScB genomes were CRISPR insertation occured. 
## 1. BLAST genomes to find cloest match to sequence from S288C (which homology was orginally from)
## 2. Edit chromosomes by replacing best fit homology with insert region

## BLAST the region from natalie based on notes from the past

nano scb_homology_regions.txt

>CrtI_Xd_Int_ChXII
ACCAACTTTTATATGAATATATTGTGCTACATGTCTTAATTAGTCCTCTGTGAATGAGCATCACAAAGAATCACGAGGAAAAGATTGATTACTTAATATTGATAGGAATCAGCCGCGGAAATGGAAATCTTGGTAATATAATTTTAATGCGGGCCGGTACCGGAGCCCTATTGATTCCGCGGAAATAGGCGGATTATTACAAACGTTGAGCATTCAGCAGGTGCGGCTGTGCCTTTTCACTTTCAGCTAAGATGTTTGCAAGCAAGAATTAACAGATAAGCCGCTTCGCTAGTAACGCAACTCATTGTGTT
>CrtE_Xd_ypl062w_ChXVI
GTATAATCCCGGGTGGAAACTAAACTAAAAACCGTACTCACAACTTTCCGCGGACGCTAACAGACAAATAGACACACTATCAGGTCAGGAACTGCCGTCACATACGACACTGCCCCTCACGTAAGGGCATGATAGAATTGGATTATGTAAAAGGTGAAGATACCATTGTAGAAGCAACCAGCACGTCGCCGTGGCTGATGGCTATTTATTGTGATAGGCCCCTACGAGTTGAAGGTAGTAAGGGCACCTCTTGCCCGGGCCGCAGAAAAGAGGGGCAGTGGCCTGTTTTTCGACATAAATGAGGGGCATGGCCAGCACCGAGACGTCATTGTTGCATATGGCGTATCCAAGCCGAAACGGCGCTCGCCTCATCCCCACGGGAATAAGGCAGCCGACAAAAGAAAAACGACCGAAAAGGAACCAGAAAGAAAAAAGAGGGTGGGCGCGC
>CrtYB_Xd_Leu2_III
ATACTTGAAGTTGACAATATTATTTAAGGACCTATTGTTTTTTCCAATAGGTGGTTAGCAATCGTCTTACTTTCTAACTTTTCTTACCTTTTACATTTCAGCAATATATATATATATATATATTTCAAGGATATACCATTGTAATGTCTGCCCCTAAGAAGATCGTCGTTTTGCCAGGTGACCACGTTGGTCAAGAAATCACCGCGAATCCTTACATCACACCCAATCCCCCACAAGTGGCCTCTTAAAGCTATTTCTGATGTTCGTTCCAATGTCAAGTTCGATTTCGAAAATCATTTAATTGGTGGTGCTGCTATCGATGCTACAGGTGTTCCACTTCCAGATGAGGCGCTGGAAGCCTCCAAGAAGGCTGATGCCGTTTTGTTAGGTGCTGTGGGTGGTCCTAAATGGGGTACCGGTAGTGTTAGACCTGAACAAGGTTC

nano 2023_insert.txt
################## 2023_insert.txt ##############
## CrtI_Xd
TCATTATCAATACTGCCATTTCAAAGAATACGTAAATAATTAATAGTAGTGATTTTCCTAACTTTATTTAGTCAAAAAATTAGCCTTTTAATTCTGCTGTAACCCGTACATGCCCAAAATAGGGGGCGGGTTACACAGAATATATAACATCGTAGGTGTCTGGGTGAACAGTTTATTCCTGGCATCCACTAAATATAATGGAGCCCGCTTTTTAAGCTGGCATCCAGAAAAAAAAAGAATCCCAGCACCAAAATATTGTTTTCTTCACCAACCATCAGTTCATAGGTCCATTCTCTTAGCGCAACTACAGAGAACAGGGGCACAAACAGGCAAAAAACGGGCACAACCTCAATGGAGTGATGCAACCTGCCTGGAGTAAATGATGACACAAGGCAATTGACCCACGCATGTATCTATCTCATTTTCTTACACCTTCTATTACCTTCTGCTCTCTCTGATTTGGAAAAAGCTGAAAAAAAAGGTTGAAACCAGTTCCCTGAAATTATTCCCCTACTTGACTAATAAGTATATAAAGACGGTAGGTATTGATTGTAATTCTGTAAATCTATTTCTTAAACTTCTTAAATTCTACTTTTATAGTTAGTCTTTTTTTTAGTTTTAAAACACCAAGAACTTAGTTTCGAATAAACACACATAAACAAACAAAATGGGTAAAGAACAAGATCAAGATAAGCCAACCGCTATTATAGTTGGTTGTGGTATTGGTGGTATAGCTACTGCTGCTAGATTGGCTAAAGAAGGTTTTCAAGTTACCGTGTTCGAAAAGAACGATTACTCTGGTGGTAGATGCTCCTTGATTGAAAGAGATGGTTACAGATTTGACCAGGGTCCATCTTTGTTGTTGTTGCCAGATTTGTTCAAGCAGACCTTTGAAGATTTGGGTGAGAAAATGGAAGATTGGGTCGATTTGATTAAGTGCGAACCTAACTACGTTTGCCATTTCCATGATGAAGAAACCTTCACTTTGTCTACCGATATGGCTTTGTTGAAGAGAGAAGTCGAAAGATTCGAAGGTAAGGATGGTTTCGATAGGTTCTTGTCCTTTATTCAAGAGGCCCATAGACATTACGAATTGGCTGTTGTTCACGTCTTGCAAAAGAATTTTCCAGGTTTTGCTGCCTTCTTGAGATTGCAATTCATCGGTCAAATTTTGGCCTTGCATCCATTCGAATCTATTTGGACTAGAGTGTGCAGATACTTCAAGACCGATAGATTGAGAAGGGTTTTCTCTTTCGCTGTTATGTACATGGGTCAATCTCCATATTCTGCTCCAGGTACTTATTCTTTGTTGCAGTACACTGAATTGACCGAAGGTATTTGGTATCCAAGAGGTGGTTTTTGGCAAGTTCCAAACACTTTGTTACAGATCGTCAAGAGAAACAACCCATCTGCTAAGTTTAATTTCAACGCCCCAGTTTCTCAAGTCTTGTTGTCTCCAGCTAAAGATAGAGCTACAGGTGTTAGATTGGAATCCGGTGAAGAACATCATGCCGATGTTGTTATAGTTAACGCCGATTTGGTTTACGCCTCCGAACATTTGATTCCAGATGATGCTAGAAACAAGATTGGTCAATTAGGTGAAGTCAAGAGATCTTGGTGGGCTGATTTGGTTGGTGGTAAAAAGTTGAAGGGTTCCTGTTCTTCTTTGTCCTTTTACTGGTCTATGGACAGAATCGTTGATGGTTTAGGTGGTCACAATATTTTCTTGGCCGAAGATTTTAAGGGTAGCTTCGATACCATTTTCGAAGAATTGGGTTTGCCAGCTGATCCATCTTTCTATGTTAATGTCCCATCCAGAATTGATCCATCAGCTGCACCTGAAGGTAAAGATGCTATAGTTATTTTGGTTCCATGCGGTCATATTGACGCTTCTAATCCACAAGATTACAACAAGTTGGTTGCTAGAGCTAGAAAGTTCGTTATCCATACTTTGTCCGCTAAGTTGGGTTTACCAGACTTTGAAAAAATGATCGTTGCCGAAAAGGTTCATGATGCTCCATCTTGGGAAAAAGAGTTTAACTTGAAGGACGGTTCCATTTTGGGTTTAGCTCATAACTTCATGCAAGTCTTGGGTTTCAGACCATCTACTAGACATCCTAAGTACGACAAGTTGTTTTTCGTTGGTGCTTCTACTCATCCTGGTACTGGTGTTCCAATAGTTTTGGCTGGTGCTAAATTGACCGCTAATCAAGTTTTGGAATCCTTCGATAGATCTCCAGCTCCAGATCCAAATATGTCTTTGTCTGTTCCATACGGTAAGCCCTTGAAATCTAATGGTACAGGTATTGACTCTCAGGTCCAGTTGAAGTTTATGGATTTGGAAAGATGGGTCTACCTGTTGGTTTTGTTGATTGGTGCTGTTATCGCTAGATCTGTTGGTGTTTTGGCTTTCTGATGATCATGTAATTAGTTATGTCACGCTTACATTCACGCCCTCCCCCCACATCCGCTCTAACCGAAAAGGAAGGAGTTAGACAACCTGAAGTCTAGGTCCCTATTTATTTTTTTATAGTTATGTTAGTATTAAGAACGTTATTTATATTTCAAATTTTTCTTTTTTTTCTGTACAGACGCGTGTACGCATGTAACATTATACTGAAAACCTTGCTTGAGAAGGTTTTGGGACGCTCGAAGGCTTTAATTTGC
## CrtE_Xd
GCTCCTCCATAGCTTCAAAATGTTTCTACTCCTTTTTTACTCTTCCAGATTTTCTCGGACTCCGCGCATCGCCGTACCACTTCAAAACACCCAAGCACAGCATACTAAATTTCCCCTCTTTCTTCCTCTAGGGTGTCGTTAATTACCCGTACTAAAGGTTTGGAAAAGAAAAAAGTGACCGCCTCGTTTCTTTTTCTTCGTCGAAAAAGGCAATAAAAATTTTTATCACGTTTCTTTTTCTTGAAAATTTTTTTTTTTGATTTTTTTCTCTTTCGATGACCTCCCATTGATATTTAAGTTAATAAACGGACTTCAATTTCTCAAGTTTCAGTTTCATTTTTCTTGTTCTATTACAACTTTTTTTACTTCTTGCTCATTAGAAAGAAAGCATAGCAATCTAATCTAAGTTTAAAATGGACTACGCCAACATCTTGACCGCTATTCCATTGGAATTCACTCCACAAGATGACATCGTTTTGTTGGAACCATATCACTACTTGGGTAAGAACCCAGGTAAAGAAATCAGATCCCAATTGATTGAAGCCTTCAACTATTGGTTGGACGTCAAGAAAGAAGATTTGGAAGTTATCCAAAACGTCGTCGGTATGTTGCATACTGCATCTTTGTTGATGGATGACGTCGAAGATTCTTCCGTTTTGAGAAGAGGTTCTCCAGTTGCTCATTTGATCTATGGTATTCCACAAACCATTAACACCGCCAACTACGTTTACTTTTTGGCCTACCAAGAAATCTTCAAGTTAAGACCAACTCCAATCCCAATGCCAGTTATTCCACCATCTTCAGCTTCATTGCAATCCTCTGTTTCTTCTGCTTCTAGTTCTTCTTCTGCCTCTTCTGAAAATGGTGGTACTTCTACTCCAAACTCCCAAATTCCATTCTCTAAGGATACCTACTTGGATAAGGTTATCACCGACGAAATGTTGTCATTGCATAGAGGTCAAGGTTTAGAATTATTCTGGAGAGATTCTTTGACCTGCCCATCTGAAGAAGAATACGTTAAGATGGTTTTGGGTAAAACCGGTGGTTTGTTCAGAATTGCTGTTAGATTGATGATGGCCAAGTCCGAATGTGATATCGATTTCGTTCAATTGGTCAACTTGATCTCCATCTACTTTCAAATCAGAGATGACTATATGAACTTGCAATCCAGTGAATACGCCCACAACAAGAATTTTGCTGAAGATTTGACCGAAGGTAAATTCTCCTTCCCAACCATTCATTCCATTCATGCTAATCCATCTTCTAGATTGGTCATCAACACCTTGCAAAAGAAGTCTACTTCTCCAGAAATCTTGCATCACTGCGTTAACTACATGAGAACCGAAACTCATTCTTTCGAATACACCCAAGAAGTCTTGAACACTTTGTCTGGTGCTTTGGAAAGAGAATTGGGTAGATTACAAGGTGAATTCGCTGAAGCCAACTCTAAGATTGATTTGGGTGATGTTGAATCCGAAGGTAGAACTGGTAAGAACGTTAAGTTGGAAGCTATCTTGAAGAAGTTGGCTGATATCCCATTGTGATGAATCATGTAATTAGTTATGTCACGCTTACATTCACGCCCTCCCCCCACATCCGCTCTAACCGAAAAGGAAGGAGTTAGACAACCTGAAGTCTAGGTCCCTATTTATTTTTTTATAGTTATGTTAGTATTAAGAACGTTATTTATATTTCAAATTTTTCTTTTTTTTCTGTACAGACGCGTGTACGCATGTAACATTATACTGAAAACCTTGCTTGAGAAGGTTTTGGGACGCTCGAAGGCTTTAATTTGC## CrtYB_Xd
## CrtYB_Xd_Leu2_III
GATCCCCCACACACCATAGCTTCAAAATGTTTCTACTCCTTTTTTACTCTTCCAGATTTTCTCGGACTCCGCGCATCGCCGTACCACTTCAAAACACCCAAGCACAGCATACTAAATTTCCCCTCTTTCTTCCTCTAGGGTGTCGTTAATTACCCGTACTAAAGGTTTGGAAAAGAAAAAAGAGACCGCCTCGTTTCTTTTTCTTCGTCGAAAAAGGCAATAAAAATTTTTATCACGTTTCTTTTTCTTGAAAATTTTTTTTTTTGATTTTTTTCTCTTTCGATGACCTCCCATTGATATTTAAGTTAATAAACGGTCTTCAATTTCTCAAGTTTCAGTTTCATTTTTCTTGTTCTATTACAACTTTTTTTACTTCTTGCTCATTAGAAAGAAAGCATAGCAATCTAATCTAAGTTTTAATTACAAAATGACTGCTTTGGCCTACTACCAAATCCATTTGATCTACACCTTGCCAATCTTGGGTTTGTTGGGTTTATTGACCTCTCCAATTTTGACCAAGTTCGACATCTACAAGATCAGTATCTTGGTCTTTATTGCTTTCTCTGCTACTACTCCTTGGGATTCCTGGATTATTAGAAATGGTGCTTGGACTTATCCATCCGCTGAATCTGGTCAAGGTGTTTTTGGTACTTTTTTGGATGTCCCATACGAAGAATACGCTTTCTTCGTTATTCAAACCGTTATCACCGGTTTGGTTTACGTTTTGGCTACTAGACATTTGTTGCCATCTTTGGCTTTGCCAAAGACTAGATCATCTGCTTTGTCTTTAGCTTTGAAGGCCTTGATTCCATTGCCAATCATCTACTTGTTTACCGCTCATCCATCTCCATCACCAGATCCATTGGTTACTGATCATTACTTCTACATGAGAGCCTTGTCCTTGTTGATTACTCCACCAACTATGTTGTTGGCTGCTTTATCTGGTGAATATGCTTTCGATTGGAAATCCGGTAGAGCTAAGTCTACTATTGCTGCCATTATGATTCCAACCGTTTACTTGATTTGGGTTGATTACGTTGCTGTTGGTCAAGATTCTTGGTCTATTAACGACGAAAAAATCGTCGGTTGGAGATTGGGTGGTGTTTTGCCTATTGAAGAAGCTATGTTCTTCTTGTTGACCAACTTGATGATCGTTTTGGGTTTGAGTGCTTGTGATCATACTCAAGCCTTGTATTTGTTGCATGGTAGAACTATCTACGGTAACAAAAAGATGCCATCCTCCTTCCCATTGATTACACCTCCAGTTTTGTCTTTGTTCTTCTCATCTAGACCATACTCCTCTCAACCTAAGAGAGATTTGGAATTGGCTGTCAAGTTGTTGGAAGAAAAGTCCAGATCCTTTTTCGTTGCTTCTGCTGGTTTTCCATCTGAAGTTAGAGAAAGATTGGTTGGTTTGTACGCCTTCTGTAGAGTTACCGATGATTTGATTGATTCCCCAGAAGTTTCTTCTAACCCACATGCTACTATCGATATGGTTTCTGATTTCTTGACCTTGTTGTTTGGTCCACCATTGCATCCATCACAACCAGATAAGATTTTGTCCTCTCCATTATTGCCACCATCACATCCTTCTAGACCAACTGGTATGTATCCATTGCCTCCACCACCATCTTTGTCTCCAGCTGAATTGGTTCAATTCTTGACTGAAAGAGTTCCAGTCCAATACCATTTCGCCTTTAGATTATTGGCTAAGTTGCAAGGTTTGATCCCAAGATATCCATTGGATGAATTATTGAGAGGTTACACCACCGATTTGATTTTCCCATTGTCTACTGAAGCTGTTCAAGCTAGAAAGACTCCTATTGAAACTACCGCTGATTTGTTGGATTACGGTTTGTGTGTTGCTGGTTCTGTTGCAGAATTATTGGTTTATGTTTCTTGGGCTTCTGCCCCATCTCAAGTTCCAGCTACCATTGAAGAAAGAGAAGCTGTTTTGGTTGCCTCTAGAGAAATGGGTACTGCATTGCAATTAGTCAACATTGCCAGAGATATTAAGGGTGATGCTACTGAAGGTAGATTCTACTTGCCATTGTCATTCTTCGGTTTGAGAGATGAATCCAAGTTGGCTATTCCAACTGATTGGACTGAACCTAGACCACAAGATTTCGATAAGTTGTTGTCATTGTCTCCATCTTCCACTTTGCCAAGTTCTAATGCTTCTGAATCCTTCAGATTCGAATGGAAAACTTACTCTTTGCCATTGGTTGCTTACGCTGAAGATTTGGCTAAACATTCCTACAAGGGTATCGATAGATTGCCAACTGAAGTTCAAGCTGGTATGAGAGCTGCTTGTGCTTCTTATTTGTTAATCGGTAGAGAAATCAAGGTCGTTTGGAAAGGTGATGTTGGTGAAAGAAGAACTGTTGCAGGTTGGAGAAGAGTTAGAAAGGTTTTGTCAGTTGTTATGTCTGGTTGGGAAGGTCAATGATGATCATGTAATTAGTTATGTCACGCTTACATTCACGCCCTCCCCCCACATCCGCTCTAACCGAAAAGGAAGGAGTTAGACAACCTGAAGTCTAGGTCCCTATTTATTTTTTTATAGTTATGTTAGTATTAAGAACGTTATTTATATTTCAAATTTTTCTTTTTTTTCTGTACAGACGCGTGTACGCATGTAACATTATACTGAAAACCTTGCTTGAGAAGGTTTTGGGACGCTCGAAGGCTTTAATTTG
#######################################

## Get genomes

aws s3 cp s3://bn-seq-data/bn1_sp/Ref_Genomes/Spades/ScB_RefGenome/GCA_001298375.2_ASM129837v2_genomic.fna scb_genome_edits/ref_genome/

## Make Databases

makeblastdb -in ref_genome/GCA_001298375.2_ASM129837v2_genomic.fna  -dbtype nucl


## Blast'em

blastn -task blastn \
  -query scb_homology_regions.txt  \
  -db ref_genome/GCA_001298375.2_ASM129837v2_genomic.fna \
   -evalue 1e-50 \
   -num_threads 2 \
   -outfmt "6 qseqid sseqid sseq" \
    -out scb_homology_blastn.txt 

## !!!!! CrtYB Region mapping to fragment !!!!!!#####

## Remove gaps
sed -i '/^[^>]/s/-//g' scb_homology_blastn.txt 

## Write Script to Edit Genome file
## Input_Homology: File with homology sites in orignal file
## Input_Insert: File with homology+insert
## Variable: Reference file 
## Variable: New Name
nano genome_edit_writter.sh 

######
homology_regions.txt ## From general Sc genome, used to make crispr insert homology regions
scy55_homology_blastn.txt ## Output from BLASTing CRIPR homology regions against strain genome. Input for editing writer file
homology_regions.txt ## Used to check for presence/removeal of strain specific sequence

1034_insert.txt ## Regions to add to genome. Needs the same number of rows as homology


################ gene_replacer_w.sh ######################
Reference_file='ref_genome/GCA_001298375.2_ASM129837v2_genomic.fna'

RUNNER_FILE='scb_2023.sh'
FILE1='scb_homology_blastn.txt'
FILE2='2023_insert.txt'
FILE3='temp.txt'

## Set up RefGenome Names
COUNT='1'

OUTPUT=${Reference_file/.fna/_2023_}

START="$OUTPUT$COUNT.fna"
cp $Reference_file $START

## Select Sequence (col 3) from blast output
printf '' > $FILE3

awk -F'\t' '{print $3}' $FILE1  > $FILE3

printf '' > $RUNNER_FILE

while IFS= read -r F1 <&3 && IFS= read -r F2 <&4; do

HOMOLOGY=$F1
INSERT=$F2

NEW=$((COUNT +1))
## -i for ignore case
## -s for search the sequence not the title which is the default
echo "seqkit replace -i -s -p '$HOMOLOGY' -r '$INSERT' $OUTPUT$COUNT.fna > $OUTPUT$NEW.fna" >>$RUNNER_FILE

((COUNT+=1))

done 3<"$FILE3" 4<"$FILE2"

###########################

## Check the input for the starting sequences

makeblastdb -in ref_genome/GCA_001298375.2_ASM129837v2_genomic_2023_1.fna  -dbtype nucl

sed -i '/^[^>]/s/-//g' scb_homology_check.txt 

blastn -task blastn \
 -query scb_homology_check.txt \
  -db ref_genome/GCA_001298375.2_ASM129837v2_genomic_2023_1.fna  \
  -evalue 1e-10 \
  -num_threads 2 \
    -out pre_checking.txt 
## All are there! 

bash y55_2_1043.sh

## Index new ref genome
makeblastdb -in ref_genome/GCA_001298375.2_ASM129837v2_genomic_2023_4.fna  -dbtype nucl

### Checl for Orginal Seq

blastn -task blastn \
 -query scb_homology_check.txt  \
  -db ref_genome/GCA_001298375.2_ASM129837v2_genomic_2023_4.fna \
  -evalue 1e-10 \
  -num_threads 2 \
    -out post_checking.txt 
## Left on fragment not on main chrom 
## Added Seq 

blastn -task blastn \
 -query 2023_insert_checking.txt  \
  -db ref_genome/GCA_001298375.2_ASM129837v2_genomic_2023_4.fna  \
  -num_threads 2 \
  -evalue 1e-10 \
    -out insert_checking.txt 

### All three went in!! I can advance to aligning for mutation calling. Still need to update the .gft before starting RNAseq processing.